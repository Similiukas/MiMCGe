#!/bin/bash

# Generating a list of encrypted numbers for NIST STS testing data
# The generated list is a simple list of encrypted numbers from 0 to num_calls
# Goal is to have at least 127 (block size) * n > 10 000 because this is the minimum bitstream size for some NIST STS tests
# Then, can call NIST STS ./assess 79*127 = 10033 with some bitstreams

# To get the file, pipe the result to text file: ./script.sh > test.txt
# To verify that the file indeed has enough bytes: tr -dc 01 < test.txt | wc -m
# This number should be equal to bitstreams * assess input which is essentially file size in bytes
# To get at least 100MB: bitstreams 100 with 7875 rows

exponent=5
key=10662188815737599170304756547421749192
# 81 round constants for x^3
#round_constants=(0 74587870783305527849921760971674753273 127484964542829958050091997998589822260 102224274465077178390902918798025097186 12712509146507536975488773036937090148 149217848564931804325075829360421705768 9336899913993780203071260955708012387 17796884737955178911759447343108704356 36851706377970008080919606210602859209 13342713325719936262438875354699996765 62077604152020371515613188125408869477 154931804292711061934150949878847020971 45482738240111077354927998171002844064 29991163429942933389128760669706761932 140733495634038881917107379309732207277 85723418318779094577991205370858253669 134853219656997837430878746567667592621 140407424872325932077979777294390990508 167209124486030621645565554846068686935 140464628532101878406785799022161258769 134358526691402806340102924223275346602 5308136739005960321423403246495044765 137953187092836064930222639358398476494 70814469656719523775230674713263961296 84356798824630553743369626642899685848 57136221504572459660822477132582056241 33032348928942158669930828709972992712 123144529572693345155682654075266516423 62157172944880772091734799441429331205 104473979977004365993761313775487931598 116438733416617932592635895455246666469 86829972932036200690611839020401244201 98960729574459404713006005581871434173 89374387296787318804426331796922630218 117811817697105234311040132924037824591 93038526839536948681754432183114605808 79061445119943143623228104918277070835 47080395141882571793868864614172100065 71961182414081187919587810329935394476 60276066751380186078804065312087668216 155754796669900332239503588402058209558 74762926571041592173210445303355923402 32612027244372584489481897485524129783 34915984733122656517899982982729429724 120543673627729316034449500872172938725 61484576287639669081388406515435621190 4842888777864717052358250106194397082 142035260880177483556629309455362727095 24616977750531425154244674781206437179 161345838975278152919266713753731380084 94025364309362885308296602716051109640 122538026295638060114312366358461143969 165217410545935031460221561400622993050 66043264335004627348411991868456307103 34769027482022661016752109061023239554 63999776514270868347980989698550523637 117563924372881456352970509503271116002 88592519367899972586599496420259704015 151002261175712170265895061562572435575 14479689337408464515962114654824325908 129459829457069872304108650777101714834 99604322872883047746056605309761042226 139457205766188170603616926533237915031 137444927623640745710264260676814951017 96748867236825587258022875490753445496 167137648297957504274624580582433026921 86770873223588989678916041940351931208 100451673710067968516607957020093881280 70244175739230846223738890434874886295 41939355649825333270881087076420328672 92825532451288340932169462061411234238 115937716246907003290297001131493287922 57687519148412058296412434999557163184 113554955587261195993090353263744931959 159829079048341173025876876267764941659 1313881690856686131423159129005587577 156924121628323873240338771241163751754 149989919312775717219451488664748096494 54493036373821615188130795368421669214 4964494719862138376636579900566722755 75399566027697214956584710517874117874)
# 55 round constants for x^5
round_constants=(0 74587870783305527849921760971674753273 127484964542829958050091997998589822260 102224274465077178390902918798025097186 12712509146507536975488773036937090148 149217848564931804325075829360421705768 9336899913993780203071260955708012387 17796884737955178911759447343108704356 36851706377970008080919606210602859209 13342713325719936262438875354699996765 62077604152020371515613188125408869477 154931804292711061934150949878847020971 45482738240111077354927998171002844064 29991163429942933389128760669706761932 140733495634038881917107379309732207277 85723418318779094577991205370858253669 134853219656997837430878746567667592621 140407424872325932077979777294390990508 167209124486030621645565554846068686935 140464628532101878406785799022161258769 134358526691402806340102924223275346602 5308136739005960321423403246495044765 137953187092836064930222639358398476494 70814469656719523775230674713263961296 84356798824630553743369626642899685848 57136221504572459660822477132582056241 33032348928942158669930828709972992712 123144529572693345155682654075266516423 62157172944880772091734799441429331205 104473979977004365993761313775487931598 116438733416617932592635895455246666469 86829972932036200690611839020401244201 98960729574459404713006005581871434173 89374387296787318804426331796922630218 117811817697105234311040132924037824591 93038526839536948681754432183114605808 79061445119943143623228104918277070835 47080395141882571793868864614172100065 71961182414081187919587810329935394476 60276066751380186078804065312087668216 155754796669900332239503588402058209558 74762926571041592173210445303355923402 32612027244372584489481897485524129783 34915984733122656517899982982729429724 120543673627729316034449500872172938725 61484576287639669081388406515435621190 4842888777864717052358250106194397082 142035260880177483556629309455362727095 24616977750531425154244674781206437179 161345838975278152919266713753731380084 94025364309362885308296602716051109640 122538026295638060114312366358461143969 165217410545935031460221561400622993050 66043264335004627348411991868456307103 34769027482022661016752109061023239554)
# 32 round constants for x^16
#round_constants=(0 74587870783305527849921760971674753273 127484964542829958050091997998589822260 102224274465077178390902918798025097186 12712509146507536975488773036937090148 149217848564931804325075829360421705768 9336899913993780203071260955708012387 17796884737955178911759447343108704356 36851706377970008080919606210602859209 13342713325719936262438875354699996765 62077604152020371515613188125408869477 154931804292711061934150949878847020971 45482738240111077354927998171002844064 29991163429942933389128760669706761932 140733495634038881917107379309732207277 85723418318779094577991205370858253669 134853219656997837430878746567667592621 140407424872325932077979777294390990508 167209124486030621645565554846068686935 140464628532101878406785799022161258769 134358526691402806340102924223275346602 5308136739005960321423403246495044765 137953187092836064930222639358398476494 70814469656719523775230674713263961296 84356798824630553743369626642899685848 57136221504572459660822477132582056241 33032348928942158669930828709972992712 123144529572693345155682654075266516423 62157172944880772091734799441429331205 104473979977004365993761313775487931598 116438733416617932592635895455246666469 86829972932036200690611839020401244201)
# 28 round constants for x^24
#round_constants=(0 74587870783305527849921760971674753273 127484964542829958050091997998589822260 102224274465077178390902918798025097186 12712509146507536975488773036937090148 149217848564931804325075829360421705768 9336899913993780203071260955708012387 17796884737955178911759447343108704356 36851706377970008080919606210602859209 13342713325719936262438875354699996765 62077604152020371515613188125408869477 154931804292711061934150949878847020971 45482738240111077354927998171002844064 29991163429942933389128760669706761932 140733495634038881917107379309732207277 85723418318779094577991205370858253669 134853219656997837430878746567667592621 140407424872325932077979777294390990508 167209124486030621645565554846068686935 140464628532101878406785799022161258769 134358526691402806340102924223275346602 5308136739005960321423403246495044765 137953187092836064930222639358398476494 70814469656719523775230674713263961296 84356798824630553743369626642899685848 57136221504572459660822477132582056241 33032348928942158669930828709972992712 123144529572693345155682654075266516423)

bitstreams=100 # Has to be at least 55 as stated in NIST STS section 5.
num_calls=$((7875*bitstreams))

./target/release/mimcge generate-test-samples mimcge 127 -t "$num_calls" -k "$key" -e "$exponent" --round-constants "${round_constants[@]}"
